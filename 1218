SELECT * FROM EMPLOYEES;
SELECT COUNT(*) FROM EMPLOYEES;
SELECT * FROM DEPARTMENTS;

SELECT *
FROM DEPARTMENTS d ;

SELECT COUNT(*) 
FROM DEPARTMENTS d ;


SELECT e.EMPLOYEE_ID, e.FIRST_NAME , e.LAST_NAME 
FROM EMPLOYEES e;

SELECT e.FIRST_NAME , e.PHONE_NUMBER , e.HIRE_DATE , e.SALARY 
FROM EMPLOYEES e ;

SELECT e.FIRST_NAME , e.LAST_NAME , e.SALARY , e.PHONE_NUMBER , e.EMAIL , e.SALARY 
FROM EMPLOYEES e ;

SELECT EMPLOYEE_ID AS "empNO", FIRST_NAME "E-name", SALARY "연 봉"
FROM EMPLOYEES;

SELECT FIRST_NAME AS "이름", PHONE_NUMBER "전화번호" , HIRE_DATE "입사일" , SALARY "급여"
FROM EMPLOYEES;

SELECT e.EMPLOYEE_ID "사원번호", 
		e.FIRST_NAME "이름", 
		e.LAST_NAME "성", 
		e.SALARY "급여" , 
		e.PHONE_NUMBER "전화번호" , 
		e.EMAIL "이메일", 
		e.HIRE_DATE "입사일" 
FROM EMPLOYEES e;

SELECT FIRST_NAME , LAST_NAME 
FROM EMPLOYEES; 

SELECT FIRST_NAME || LAST_NAME 
FROM EMPLOYEES;

SELECT FIRST_NAME || ' ' || LAST_NAME 
FROM EMPLOYEES;

SELECT FIRST_NAME || ' hire date is ' || HIRE_DATE  "입사일"
FROM EMPLOYEES;

SELECT FIRST_NAME , SALARY  
FROM EMPLOYEES; 

SELECT FIRST_NAME , SALARY , SALARY * 12
FROM EMPLOYEES;

SELECT FIRST_NAME , SALARY , SALARY * 12, (SALARY+300) * 12
FROM EMPLOYEES;

SELECT JOB_ID, SALARY , HIRE_DATE 
FROM EMPLOYEES e; 

SELECT FIRST_NAME || '-' || LAST_NAME "성명", 
		SALARY "급여" , 
		SALARY * 12 "연봉",
		SALARY * 12 + 5000 "연봉2",
		PHONE_NUMBER "전화번호"  
FROM EMPLOYEES;

SELECT FIRST_NAME 
FROM EMPLOYEES
WHERE EMPLOYEES.DEPARTMENT_ID > 10;

SELECT FIRST_NAME, SALARY , SALARY * 12
FROM EMPLOYEES
WHERE SALARY >= 15000;

SELECT *
FROM EMPLOYEES
WHERE HIRE_DATE > '01/JAN/07';

SELECT SALARY  
FROM EMPLOYEES
WHERE FIRST_NAME = 'Lex';

SELECT  FIRST_NAME, SALARY  
FROM EMPLOYEES
WHERE  SALARY <= 14000 
OR SALARY >= 17000;

SELECT FIRST_NAME, HIRE_DATE
FROM EMPLOYEES
WHERE HIRE_DATE >= '01/jan/04'
AND HIRE_DATE <= '31/dec/05';

SELECT FIRST_NAME , LAST_NAME , SALARY 
FROM EMPLOYEES 
WHERE FIRST_NAME IN ('Neena', 'Lex', 'John');

SELECT FIRST_NAME , SALARY 
FROM EMPLOYEES 
WHERE SALARY  IN (2100, 3100, 4100, 5100);

select first_name, last_name, salary
from employees
where first_name like 'L%';

select first_name, salary
from employees
where first_name like '%am%';

select first_name, salary
from employees
where first_name like '_a%';

select first_name, salary
from employees
where first_name like '___a%';

select first_name, salary
from employees
where first_name like '__a_';

select first_name, salary, commission_pct
from employees
where commission_pct is null;

select first_name, salary, commission_pct
from employees
where commission_pct is NOT null;

select first_name
from employees
where commission_pct is NULL
AND MANAGER_ID IS NULL;

select first_name, salary
from employees
order by salary ASC ;

select first_name, salary
from employees
order by salary desc;

select first_name, salary
from employees
where salary >= 9000
order by 2 desc;

SELECT DEPARTMENT_ID, SALARY , FIRST_NAME  
FROM EMPLOYEES e 
ORDER BY DEPARTMENT_ID ASC;

SELECT FIRST_NAME , SALARY 
FROM EMPLOYEES e 
WHERE SALARY >= 5000
ORDER BY SALARY desc ;

SELECT DEPARTMENT_ID , SALARY , FIRST_NAME 
FROM EMPLOYEES e 
ORDER BY 1 ASC, 2 DESC ;

SELECT FIRST_NAME "이름" , SALARY "월급", PHONE_NUMBER "전화번호", HIRE_DATE "입사일"
FROM EMPLOYEES e 
ORDER BY 4;

SELECT JOB_ID "업무", SALARY "월급"
FROM EMPLOYEES e 
ORDER BY 2 desc;

select first_name, MANAGER_ID , commission_pct, salary
from employees
where SALARY > 3000
AND MANAGER_ID IS NOT NULL 
AND commission_pct is null;

SELECT JOB_TITLE , MAX_SALARY 
FROM JOBS j 
WHERE MAX_SALARY >= 10000
ORDER BY 2 DESC;

select email, initcap(email), department_id
from employees
where department_id = 100;

SELECT FIRST_NAME , LOWER(FIRST_NAME) , UPPER(FIRST_NAME) 
FROM EMPLOYEES e 
WHERE DEPARTMENT_ID = 100 ;

SELECT FIRST_NAME , SUBSTR(FIRST_NAME,1,3) , SUBSTR(FIRST_NAME,-3,2) 
FROM EMPLOYEES e 
WHERE DEPARTMENT_ID = 100;

SELECT FIRST_NAME ,
		LPAD(FIRST_NAME,10,'*') ,
		RPAD(FIRST_NAME,10,'*')
FROM EMPLOYEES e ;

SELECT FIRST_NAME ,
	REPLACE (FIRST_NAME ,'a','*')
FROM EMPLOYEES e 
WHERE DEPARTMENT_ID = 100;

SELECT FIRST_NAME ,
	REPLACE (FIRST_NAME ,'a','*'),
	REPLACE (FIRST_NAME , substr(first_name, 2, 3), '***')
FROM EMPLOYEES e 
WHERE DEPARTMENT_ID = 100;

SELECT ROUND(123.346, 2 ) "r2" ,
		ROUND(123.456, 0 ) "r0" ,
		ROUND(123.456, -1 ) "r-1" 
FROM dual;

SELECT TRUNC(123.346, 2 ) "r2" ,
		TRUNC(123.456, 0 ) "r0" ,
		TRUNC(123.456, -1 ) "r-1" 
FROM dual;

SELECT SYSDATE FROM dual;

SELECT SYSDATE FROM EMPLOYEES e ;

SELECT FIRST_NAME , HIRE_DATE , MONTHS_BETWEEN(sysdate, HIRE_DATE)
FROM EMPLOYEES  
WHERE DEPARTMENT_ID = 110;

SELECT FIRST_NAME , TO_CHAR(SALARY*12, '$999,999.99') "SAL" 
FROM EMPLOYEES e 
WHERE DEPARTMENT_ID = 110;

SELECT SYSDATE ,
		TO_CHAR(SYSDATE, 'YYYY"년" MM"월" DD"일" HH24:MI:SS')
FROM dual;

SELECT COMMISSION_PCT , NVL(COMMISSION_PCT, 0) 
FROM EMPLOYEES;

SELECT COMMISSION_PCT , NVL2(COMMISSION_PCT, 100, 0) 
FROM EMPLOYEES;


SELECT FIRST_NAME , SALARY , NVL(COMMISSION_PCT, 0) 
FROM EMPLOYEES 
WHERE SALARY >= 10000
AND SALARY < 14000
ORDER BY 2 DESC ;

SELECT FIRST_NAME , SALARY , TO_CHAR(HIRE_DATE , 'YYYY-MM') , DEPARTMENT_ID 
FROM EMPLOYEES e 
WHERE DEPARTMENT_ID = 10 -- WHERE DEPARTMENT_ID in (10,90,100);
OR DEPARTMENT_ID = 90
OR DEPARTMENT_ID = 100;

SELECT FIRST_NAME , SALARY 
FROM EMPLOYEES e 
where UPPER(first_name) like '%S%';

SELECT DEPARTMENT_NAME 
FROM DEPARTMENTS d 
ORDER BY LENGTH (DEPARTMENT_NAME) desc;

SELECT UPPER(COUNTRY_NAME )
FROM COUNTRIES c 
ORDER by 1 ASC ;

SELECT FIRST_NAME , SALARY , REPLACE(PHONE_NUMBER , '.', '-') , HIRE_DATE 
FROM EMPLOYEES e 
WHERE HIRE_DATE < '31-DEC-03';

SELECT DEPARTMENT_ID , SALARY 
FROM EMPLOYEES e 
ORDER BY DEPARTMENT_ID ASC ;

SELECT DEPARTMENT_ID , avg(SALARY)
FROM EMPLOYEES e 
GROUP BY DEPARTMENT_ID 
ORDER BY DEPARTMENT_ID  ASC ;

SELECT DEPARTMENT_ID , SUM(SALARY)
FROM EMPLOYEES e 
GROUP BY DEPARTMENT_ID 
ORDER BY DEPARTMENT_ID  ASC ;

SELECT DEPARTMENT_ID , MAX(SALARY)
FROM EMPLOYEES e 
GROUP BY DEPARTMENT_ID 
ORDER BY DEPARTMENT_ID  ASC ;

SELECT DEPARTMENT_ID , COUNT(*) , SUM(SALARY)  
FROM EMPLOYEES e 
GROUP BY DEPARTMENT_ID ;

SELECT DEPARTMENT_ID , JOB_ID , COUNT(*) , SUM(SALARY)  
FROM EMPLOYEES e 
GROUP BY DEPARTMENT_ID , JOB_ID ;

SELECT DEPARTMENT_ID , COUNT(*) , SUM(SALARY)  
FROM EMPLOYEES e 
GROUP BY DEPARTMENT_ID 
HAVING SUM(SALARY) > 20000; 

SELECT MAX(SALARY) "최고임금",
		MIN(SALARY) "최저임금",
		MAX(SALARY) - MIN(SALARY)  "최고임금 – 최저임금"
FROM EMPLOYEES e ;

SELECT TO_CHAR(MAX(HIRE_DATE) , 'YYYY"년" MM"월" DD"일"') 
FROM EMPLOYEES e ;

SELECT DEPARTMENT_ID, avg(SALARY), MAX(SALARY), MIN(SALARY)  
FROM EMPLOYEES e 
GROUP BY DEPARTMENT_ID 
ORDER BY 1 DESC ;

SELECT JOB_ID, round(avg(SALARY),0) avg, MAX(SALARY) max, MIN(SALARY) min 
FROM EMPLOYEES e 
GROUP BY JOB_ID 
ORDER BY 1 DESC ;

SELECT TO_CHAR(min(HIRE_DATE), 'YYYY"년" MM"월" DD"일"' )  
FROM EMPLOYEES  ;

SELECT DEPARTMENT_ID, 
		avg(SALARY), 
		MIN(SALARY) ,
		avg(SALARY) - MIN(SALARY)
FROM EMPLOYEES e 
GROUP BY DEPARTMENT_ID 
HAVING avg(SALARY) - MIN(SALARY) < 2000
ORDER BY 4 DESC ;

SELECT JOB_ID , MAX(SALARY) - MIN(SALARY)  
FROM EMPLOYEES e 
GROUP BY JOB_ID 
ORDER BY 2 DESC ;

SELECT EMPLOYEE_ID , SALARY ,
		CASE WHEN JOB_ID = 'AC_ACCOUNT' THEN salary + salary * 0.1
			WHEN job_ID = 'AC_MGR' THEN salary + salary * 0.2
			ELSE salary
		END job_id
FROM EMPLOYEES e ;

SELECT FIRST_NAME , DEPARTMENT_ID ,
		CASE WHEN DEPARTMENT_ID >= 10 AND DEPARTMENT_ID <= 50 THEN 'A-TEAM'
			WHEN DEPARTMENT_ID >= 60 AND DEPARTMENT_ID <= 100 THEN 'B-TEAM'
			WHEN DEPARTMENT_ID >= 110 AND DEPARTMENT_ID <= 150 THEN 'C-TEAM'
			ELSE '팀없음'
		END "팀"
FROM EMPLOYEES e ;

SELECT FIRST_NAME , DEPARTMENT_ID ,
		CASE WHEN DEPARTMENT_ID Between 10 AND 50 THEN 'A-TEAM'
			WHEN DEPARTMENT_ID Between 60 AND 100 THEN 'B-TEAM'
			WHEN DEPARTMENT_ID Between 110 AND 150 THEN 'C-TEAM'
			ELSE '팀없음'
		END "팀"
FROM EMPLOYEES e ;

SELECT first_name, em.DEPARTMENT_ID ,
		DEPARTMENT_NAME , de.DEPARTMENT_ID 
FROM EMPLOYEES em, DEPARTMENTS de
WHERE em.DEPARTMENT_ID = de.DEPARTMENT_ID ;

SELECT FIRST_NAME , JOB_TITLE 
FROM EMPLOYEES em, JOBS jb
WHERE em.JOB_ID = jb.JOB_ID ;

SELECT em.FIRST_NAME , em.JOB_ID , jb.JOB_TITLE 
FROM EMPLOYEES em, JOBS jb
WHERE em.JOB_ID = jb.JOB_ID ;

SELECT e.FIRST_NAME , d.DEPARTMENT_NAME , j.JOB_TITLE 
FROM EMPLOYEES e , DEPARTMENTS d , JOBS j 
WHERE e.DEPARTMENT_ID = d.DEPARTMENT_ID 
AND e.JOB_ID = j.JOB_ID ;

SELECT emp.first_name, MGR.FIRST_NAME 
FROM EMPLOYEES emp, EMPLOYEES mgr
WHERE emp.manager_id = mgr.EMPLOYEE_ID;

SELECT e.DEPARTMENT_ID , e.FIRST_NAME ,d.DEPARTMENT_NAME 
FROM EMPLOYEES e LEFT OUTER JOIN DEPARTMENTS d  
ON e.DEPARTMENT_ID = d.DEPARTMENT_ID ;

SELECT e.DEPARTMENT_ID , e.FIRST_NAME , d.DEPARTMENT_NAME 
FROM EMPLOYEES e , DEPARTMENTS d 
WHERE e.DEPARTMENT_ID = d.DEPARTMENT_ID (+);

SELECT e.DEPARTMENT_ID , e.FIRST_NAME ,d.DEPARTMENT_NAME 
FROM EMPLOYEES e RIGHT OUTER JOIN DEPARTMENTS d  
ON e.DEPARTMENT_ID = d.DEPARTMENT_ID ;

SELECT e.DEPARTMENT_ID , e.FIRST_NAME , d.DEPARTMENT_NAME 
FROM EMPLOYEES e , DEPARTMENTS d 
WHERE e.DEPARTMENT_ID(+) = d.DEPARTMENT_ID;

SELECT e.DEPARTMENT_ID , e.FIRST_NAME ,d.DEPARTMENT_NAME 
FROM EMPLOYEES e FULL OUTER JOIN DEPARTMENTS d  
ON e.DEPARTMENT_ID = d.DEPARTMENT_ID ;

SELECT e.EMPLOYEE_ID , e.FIRST_NAME , d.DEPARTMENT_NAME , m.FIRST_NAME 
FROM EMPLOYEES e , DEPARTMENTS d , EMPLOYEES m
WHERE e.department_ID = d.DEPARTMENT_ID 
AND e.manager_ID = m.EMPLOYEE_ID ;

SELECT r.REGION_NAME , c.COUNTRY_NAME 
FROM REGIONS r , COUNTRIES c 
WHERE r.REGION_ID = c.REGION_ID 
ORDER BY 1 DESC, 2 DESC  ;

SELECT d.DEPARTMENT_ID , d.DEPARTMENT_NAME , e.FIRST_NAME , l.CITY , c.COUNTRY_NAME , r.REGION_NAME 
FROM DEPARTMENTS d , EMPLOYEES e , LOCATIONS l , COUNTRIES c , REGIONS r 
WHERE d.MANAGER_ID = e.EMPLOYEE_ID  
AND d.LOCATION_ID = l.LOCATION_ID 
AND l.COUNTRY_ID  = c.COUNTRY_ID 
AND c.REGION_ID = r.REGION_ID ;

SELECT jh.EMPLOYEE_ID , e.FIRST_NAME || ' ' || e.LAST_NAME
FROM EMPLOYEES e , JOB_HISTORY jh , JOBS j 
WHERE e.EMPLOYEE_ID = jh.EMPLOYEE_ID 
AND jh.JOB_ID = j.JOB_ID 
AND j.JOB_TITLE = 'Public Accountant';

SELECT e.EMPLOYEE_ID , e.FIRST_NAME , e.LAST_NAME , d.DEPARTMENT_NAME 
FROM EMPLOYEES e left OUTER JOIN DEPARTMENTS d 
ON e.DEPARTMENT_ID = d.DEPARTMENT_ID 
ORDER BY 3 ASC ;

SELECT e.employee_id, e.last_name, e.hire_date, m.HIRE_DATE 
FROM EMPLOYEES e , EMPLOYEES m
WHERE e.manager_id = m.EMPLOYEE_ID 
AND e.hire_date < m.HIRE_DATE; 
